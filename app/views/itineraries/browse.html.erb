<div class="itineraries">

  <% @itineraries.try(:each) do |itinerary| %>
    <a href="/itineraries/<%= itinerary.id %>/spots/1"><%= itinerary.name %></a><br>
    <% waypoints = [] %>

    <% itinerary.spots.each do |spot| %>
      <% waypoints << [spot.latitude.to_f, spot.longitude.to_f] %>
    <% end %>

    <div class="map-canvas" data-latlong='<%= waypoints %>' style="width:300px;height:250px;margin:0 auto;display:block;"></div>
  <% end %>

</div>

<p id="demo">Click the button to get your coordinates:</p>
<button onclick="getLocation()">Try It</button>
<script>
var x=document.getElementById("demo");
function getLocation()
  {
  if (navigator.geolocation)
    {
    navigator.geolocation.getCurrentPosition(showPosition);
    }
  else{x.innerHTML="Geolocation is not supported by this browser.";}
  }
function showPosition(position)
  {
  x.innerHTML="Latitude: " + position.coords.latitude +
  "<br>Longitude: " + position.coords.longitude;
  }
</script>
